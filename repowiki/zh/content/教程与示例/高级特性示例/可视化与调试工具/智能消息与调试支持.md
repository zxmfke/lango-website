# æ™ºèƒ½æ¶ˆæ¯ä¸è°ƒè¯•æ”¯æŒ

<cite>
**æœ¬æ–‡æ¡£ä¸­å¼•ç”¨çš„æ–‡ä»¶**
- [examples/smart_messages/main.go](file://examples/smart_messages/main.go)
- [examples/smart_messages/README.md](file://examples/smart_messages/README.md)
- [graph/add_messages.go](file://graph/add_messages.go)
- [graph/builtin_listeners.go](file://graph/builtin_listeners.go)
- [graph/listeners.go](file://graph/listeners.go)
- [graph/tracing.go](file://graph/tracing.go)
- [graph/messages_graph.go](file://graph/messages_graph.go)
- [examples/listeners/main.go](file://examples/listeners/main.go)
- [examples/listeners/README.md](file://examples/listeners/README.md)
</cite>

## ç›®å½•
1. [ç®€ä»‹](#ç®€ä»‹)
2. [æ™ºèƒ½æ¶ˆæ¯æœºåˆ¶](#æ™ºèƒ½æ¶ˆæ¯æœºåˆ¶)
3. [å†…ç½®ç›‘å¬å™¨ç³»ç»Ÿ](#å†…ç½®ç›‘å¬å™¨ç³»ç»Ÿ)
4. [è°ƒè¯•æ”¯æŒåŠŸèƒ½](#è°ƒè¯•æ”¯æŒåŠŸèƒ½)
5. [é…ç½®é€‰é¡¹è¯¦è§£](#é…ç½®é€‰é¡¹è¯¦è§£)
6. [æœ€ä½³å®è·µæŒ‡å—](#æœ€ä½³å®è·µæŒ‡å—)
7. [æ€§èƒ½åˆ†æä¸ä¼˜åŒ–](#æ€§èƒ½åˆ†æä¸ä¼˜åŒ–)
8. [æ•…éšœæ’é™¤æŒ‡å—](#æ•…éšœæ’é™¤æŒ‡å—)
9. [æ€»ç»“](#æ€»ç»“)

## ç®€ä»‹

LangGraphGo æä¾›äº†ä¸€å¥—å¼ºå¤§çš„æ™ºèƒ½æ¶ˆæ¯æœºåˆ¶å’Œè°ƒè¯•æ”¯æŒç³»ç»Ÿï¼Œæ—¨åœ¨å¸®åŠ©å¼€å‘è€…æ„å»ºé«˜æ•ˆã€å¯è§‚å¯Ÿçš„å›¾å½¢åŒ–å·¥ä½œæµã€‚æœ¬æ–‡æ¡£æ·±å…¥æ¢è®¨äº†æ™ºèƒ½æ¶ˆæ¯çš„ ID åŒ¹é…æœºåˆ¶ã€å†…ç½®ç›‘å¬å™¨çš„åŠŸèƒ½ç‰¹æ€§ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨è¿™äº›å·¥å…·è¿›è¡Œæœ‰æ•ˆçš„è°ƒè¯•å’Œæ€§èƒ½ä¼˜åŒ–ã€‚

æ™ºèƒ½æ¶ˆæ¯æœºåˆ¶é€šè¿‡åŸºäº ID çš„å»é‡å’Œæ›´æ–°åŠŸèƒ½ï¼Œè§£å†³äº†ä¼ ç»Ÿæ¶ˆæ¯è¿½åŠ æ–¹å¼åœ¨èŠå¤©åº”ç”¨ä¸­çš„å±€é™æ€§ã€‚è€Œå†…ç½®ç›‘å¬å™¨ç³»ç»Ÿåˆ™æä¾›äº†å…¨é¢çš„æ‰§è¡Œç›‘æ§ã€æ€§èƒ½åˆ†æå’Œè°ƒè¯•æ”¯æŒåŠŸèƒ½ï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿæ·±å…¥äº†è§£å·¥ä½œæµçš„æ‰§è¡Œè¿‡ç¨‹ã€‚

## æ™ºèƒ½æ¶ˆæ¯æœºåˆ¶

### æ ¸å¿ƒæ¦‚å¿µ

æ™ºèƒ½æ¶ˆæ¯æœºåˆ¶çš„æ ¸å¿ƒæ˜¯ `AddMessages` reducer å‡½æ•°ï¼Œå®ƒå®ç°äº†åŸºäº ID çš„æ¶ˆæ¯åˆå¹¶é€»è¾‘ã€‚è¿™ç§è®¾è®¡ç‰¹åˆ«é€‚ç”¨äºéœ€è¦æ›´æ–°å…ˆå‰æ¶ˆæ¯çš„åœºæ™¯ï¼Œå¦‚å·¥å…·è°ƒç”¨åçš„å“åº”æ›´æ–°ã€‚

```mermaid
flowchart TD
A["æ–°æ¶ˆæ¯è¾“å…¥"] --> B{"æ£€æŸ¥æ¶ˆæ¯ç±»å‹"}
B --> |æ ‡å‡† MessageContent| C["ç›´æ¥è¿½åŠ "]
B --> |å¸¦ ID çš„æ¶ˆæ¯| D["æå– ID"]
D --> E{"ID æ˜¯å¦å­˜åœ¨ï¼Ÿ"}
E --> |ä¸å­˜åœ¨| F["è¿½åŠ åˆ°æœ«å°¾"]
E --> |å­˜åœ¨| G{"ID æ˜¯å¦åŒ¹é…ç°æœ‰æ¶ˆæ¯ï¼Ÿ"}
G --> |ä¸åŒ¹é…| F
G --> |åŒ¹é…| H["æ›´æ–°ç°æœ‰æ¶ˆæ¯"]
C --> I["è¿”å›åˆå¹¶åæ¶ˆæ¯åˆ—è¡¨"]
F --> I
H --> I
```

**å›¾è¡¨æ¥æº**
- [graph/add_messages.go](file://graph/add_messages.go#L21-L135)

### ID æå–æœºåˆ¶

æ™ºèƒ½æ¶ˆæ¯ç³»ç»Ÿæ”¯æŒå¤šç§ ID æå–æ–¹å¼ï¼Œç¡®ä¿æœ€å¤§çš„çµæ´»æ€§ï¼š

1. **æ¥å£æ–¹å¼**ï¼šå®ç° `MessageWithID` æ¥å£
2. **æ˜ å°„æ–¹å¼**ï¼šä½¿ç”¨åŒ…å« `"id"` é”®çš„ map
3. **ç»“æ„ä½“æ–¹å¼**ï¼šé€šè¿‡ç»“æ„ä½“å­—æ®µ `"ID"`

```mermaid
classDiagram
class MessageWithID {
<<interface>>
+GetID() string
+GetContent() MessageContent
}
class CustomMessage {
+string ID
+string Content
+GetID() string
+GetContent() MessageContent
}
class MapMessage {
+map[string]interface{} data
+GetID() string
}
MessageWithID <|-- CustomMessage
MessageWithID <|.. MapMessage
```

**å›¾è¡¨æ¥æº**
- [graph/add_messages.go](file://graph/add_messages.go#L10-L16)
- [graph/add_messages.go](file://graph/add_messages.go#L107-L134)

### æ¶ˆæ¯åˆå¹¶ç®—æ³•

`AddMessages` å‡½æ•°é‡‡ç”¨é«˜æ•ˆçš„åˆå¹¶ç­–ç•¥ï¼š

1. **åˆå§‹åŒ–é˜¶æ®µ**ï¼šéªŒè¯è¾“å…¥å‚æ•°ï¼Œå¤„ç†ç©ºå€¼æƒ…å†µ
2. **æ¶ˆæ¯è§£æ**ï¼šå°†æ–°æ¶ˆæ¯è½¬æ¢ä¸ºç»Ÿä¸€çš„åˆ‡ç‰‡æ ¼å¼
3. **ç´¢å¼•æ„å»º**ï¼šä¸ºç°æœ‰æ¶ˆæ¯å»ºç«‹ ID åˆ°ç´¢å¼•çš„æ˜ å°„
4. **åˆå¹¶å¤„ç†**ï¼šé€ä¸ªå¤„ç†æ–°æ¶ˆæ¯ï¼Œæ‰§è¡Œæ›´æ–°æˆ–è¿½åŠ æ“ä½œ
5. **ç±»å‹è½¬æ¢**ï¼šç¡®ä¿è¿”å›å€¼ä¸åŸå§‹ç±»å‹å…¼å®¹

**ç« èŠ‚æ¥æº**
- [graph/add_messages.go](file://graph/add_messages.go#L21-L104)

### å®é™…åº”ç”¨åœºæ™¯

æ™ºèƒ½æ¶ˆæ¯æœºåˆ¶åœ¨ä»¥ä¸‹åœºæ™¯ä¸­å‘æŒ¥é‡è¦ä½œç”¨ï¼š

- **å·¥å…·è°ƒç”¨å“åº”**ï¼šLLM ç”Ÿæˆå·¥å…·è°ƒç”¨æ¶ˆæ¯åï¼Œå·¥å…·æ‰§è¡Œå®Œæˆæ—¶æ›´æ–°å“åº”
- **é€æ­¥æ¨ç†**ï¼šAI åœ¨æ€è€ƒè¿‡ç¨‹ä¸­é€æ­¥æ›´æ–°ä¸­é—´ç»“æœ
- **çŠ¶æ€åŒæ­¥**ï¼šå¤šèŠ‚ç‚¹åä½œæ—¶çš„çŠ¶æ€ä¿¡æ¯åŒæ­¥

**ç« èŠ‚æ¥æº**
- [examples/smart_messages/main.go](file://examples/smart_messages/main.go#L1-L91)
- [examples/smart_messages/README.md](file://examples/smart_messages/README.md#L1-L45)

## å†…ç½®ç›‘å¬å™¨ç³»ç»Ÿ

### ç›‘å¬å™¨æ¶æ„

LangGraphGo æä¾›äº†å®Œæ•´çš„ç›‘å¬å™¨ç”Ÿæ€ç³»ç»Ÿï¼Œæ”¯æŒå¤šç§ç±»å‹çš„äº‹ä»¶ç›‘å¬å’Œå¤„ç†ï¼š

```mermaid
classDiagram
class NodeListener {
<<interface>>
+OnNodeEvent(ctx, event, nodeName, state, err)
}
class ProgressListener {
-writer io.Writer
-nodeSteps map[string]string
-mutex sync.RWMutex
-showTiming bool
-showDetails bool
-prefix string
+WithTiming(enabled) ProgressListener
+WithDetails(enabled) ProgressListener
+SetNodeStep(nodeName, step)
+OnNodeEvent(...)
}
class MetricsListener {
-nodeExecutions map[string]int
-nodeDurations map[string][]time.Duration
-nodeErrors map[string]int
-totalExecutions int
+GetNodeExecutions() map[string]int
+GetNodeAverageDuration() map[string]time.Duration
+PrintSummary(writer)
}
class LoggingListener {
-logger *log.Logger
-logLevel LogLevel
-includeState bool
+WithLogLevel(level) LoggingListener
+WithState(enabled) LoggingListener
+OnNodeEvent(...)
}
class ChatListener {
-writer io.Writer
-nodeMessages map[string]string
-mutex sync.RWMutex
-showTime bool
+SetNodeMessage(nodeName, message)
+OnNodeEvent(...)
}
NodeListener <|.. ProgressListener
NodeListener <|.. MetricsListener
NodeListener <|.. LoggingListener
NodeListener <|.. ChatListener
```

**å›¾è¡¨æ¥æº**
- [graph/builtin_listeners.go](file://graph/builtin_listeners.go#L13-L433)
- [graph/listeners.go](file://graph/listeners.go#L51-L335)

### äº‹ä»¶ç±»å‹ç³»ç»Ÿ

ç›‘å¬å™¨ç³»ç»Ÿæ”¯æŒä¸°å¯Œçš„äº‹ä»¶ç±»å‹ï¼Œæ¶µç›–å·¥ä½œæµæ‰§è¡Œçš„å„ä¸ªé˜¶æ®µï¼š

| äº‹ä»¶ç±»å‹ | æè¿° | è§¦å‘æ—¶æœº |
|---------|------|----------|
| `NodeEventStart` | èŠ‚ç‚¹å¼€å§‹æ‰§è¡Œ | èŠ‚ç‚¹å‡½æ•°è¢«è°ƒç”¨å‰ |
| `NodeEventComplete` | èŠ‚ç‚¹æ‰§è¡Œå®Œæˆ | èŠ‚ç‚¹å‡½æ•°æˆåŠŸè¿”å›å |
| `NodeEventError` | èŠ‚ç‚¹æ‰§è¡Œå‡ºé”™ | èŠ‚ç‚¹å‡½æ•°è¿”å›é”™è¯¯æ—¶ |
| `NodeEventProgress` | èŠ‚ç‚¹æ‰§è¡Œè¿›åº¦ | èŠ‚ç‚¹å†…éƒ¨çš„è¿›åº¦é€šçŸ¥ |
| `EventChainStart` | å›¾æ‰§è¡Œå¼€å§‹ | æ•´ä¸ªå·¥ä½œæµå¯åŠ¨æ—¶ |
| `EventChainEnd` | å›¾æ‰§è¡Œç»“æŸ | å·¥ä½œæµæ­£å¸¸å®Œæˆæ—¶ |
| `EventToolStart` | å·¥å…·æ‰§è¡Œå¼€å§‹ | å·¥å…·è°ƒç”¨å¼€å§‹æ—¶ |
| `EventToolEnd` | å·¥å…·æ‰§è¡Œç»“æŸ | å·¥å…·è°ƒç”¨å®Œæˆæ—¶ |

**ç« èŠ‚æ¥æº**
- [graph/listeners.go](file://graph/listeners.go#L10-L49)

## è°ƒè¯•æ”¯æŒåŠŸèƒ½

### æ‰§è¡Œè¿›åº¦è¿½è¸ª

ProgressListener æä¾›äº†ç›´è§‚çš„æ‰§è¡Œè¿›åº¦æ˜¾ç¤ºåŠŸèƒ½ï¼š

```mermaid
sequenceDiagram
participant App as åº”ç”¨ç¨‹åº
participant PL as ProgressListener
participant Writer as è¾“å‡ºè®¾å¤‡
App->>PL : è®¾ç½®èŠ‚ç‚¹æ­¥éª¤
App->>PL : å¼€å§‹èŠ‚ç‚¹æ‰§è¡Œ
PL->>PL : è·å–å½“å‰æ—¶é—´æˆ³
PL->>PL : æ„å»ºè¿›åº¦æ¶ˆæ¯
PL->>Writer : è¾“å‡ºè¿›åº¦ä¿¡æ¯
PL-->>App : å®Œæˆé€šçŸ¥
App->>PL : èŠ‚ç‚¹æ‰§è¡Œå®Œæˆ
PL->>PL : è®¡ç®—æ‰§è¡Œæ—¶é—´
PL->>PL : æ„å»ºå®Œæˆæ¶ˆæ¯
PL->>Writer : è¾“å‡ºå®Œæˆä¿¡æ¯
```

**å›¾è¡¨æ¥æº**
- [graph/builtin_listeners.go](file://graph/builtin_listeners.go#L70-L116)

### èŠ‚ç‚¹è€—æ—¶ç»Ÿè®¡

MetricsListener å®ç°äº†ç²¾ç¡®çš„æ€§èƒ½ç»Ÿè®¡åŠŸèƒ½ï¼š

- **æ‰§è¡Œæ¬¡æ•°ç»Ÿè®¡**ï¼šè®°å½•æ¯ä¸ªèŠ‚ç‚¹çš„æ‰§è¡Œæ¬¡æ•°
- **å¹³å‡æ‰§è¡Œæ—¶é—´**ï¼šè®¡ç®—èŠ‚ç‚¹çš„å¹³å‡æ‰§è¡Œæ—¶é—´
- **é”™è¯¯ç‡ç»Ÿè®¡**ï¼šè·Ÿè¸ªèŠ‚ç‚¹å¤±è´¥ç‡
- **æ€»æ‰§è¡Œæ¬¡æ•°**ï¼šå…¨å±€æ‰§è¡Œè®¡æ•°å™¨

```mermaid
flowchart LR
A["èŠ‚ç‚¹å¼€å§‹"] --> B["è®°å½•å¼€å§‹æ—¶é—´"]
B --> C["æ‰§è¡ŒèŠ‚ç‚¹é€»è¾‘"]
C --> D{"æ‰§è¡ŒæˆåŠŸï¼Ÿ"}
D --> |æ˜¯| E["è®°å½•æ‰§è¡Œæ—¶é—´"]
D --> |å¦| F["è®°å½•é”™è¯¯æ—¶é—´å’Œæ‰§è¡Œæ¬¡æ•°"]
E --> G["æ›´æ–°ç»Ÿè®¡æ•°æ®"]
F --> G
G --> H["ç”ŸæˆæŒ‡æ ‡æŠ¥å‘Š"]
```

**å›¾è¡¨æ¥æº**
- [graph/builtin_listeners.go](file://graph/builtin_listeners.go#L202-L351)

### è¯¦ç»†æ—¥å¿—è¾“å‡º

LoggingListener æä¾›ç»“æ„åŒ–çš„æ—¥å¿—è®°å½•åŠŸèƒ½ï¼š

- **åˆ†çº§æ—¥å¿—**ï¼šæ”¯æŒ DEBUGã€INFOã€WARNã€ERROR çº§åˆ«
- **çŠ¶æ€åŒ…å«**ï¼šå¯é€‰æ‹©æ˜¯å¦åŒ…å«æ‰§è¡ŒçŠ¶æ€ä¿¡æ¯
- **ä¸Šä¸‹æ–‡ä¿æŒ**ï¼šç»´æŠ¤æ—¥å¿—çš„ä¸Šä¸‹æ–‡å…³è”æ€§

**ç« èŠ‚æ¥æº**
- [graph/builtin_listeners.go](file://graph/builtin_listeners.go#L118-L200)

## é…ç½®é€‰é¡¹è¯¦è§£

### WithTiming é…ç½®

å¯ç”¨æˆ–ç¦ç”¨æ—¶é—´æˆ³æ˜¾ç¤ºï¼š

```go
// å¯ç”¨æ—¶é—´æˆ³ï¼ˆé»˜è®¤ï¼‰
listener.WithTiming(true)

// ç¦ç”¨æ—¶é—´æˆ³
listener.WithTiming(false)
```

### WithDetails é…ç½®

æ§åˆ¶è¯¦ç»†è¾“å‡ºçº§åˆ«ï¼š

```go
// å¯ç”¨è¯¦ç»†çŠ¶æ€ä¿¡æ¯
listener.WithDetails(true)

// ç¦ç”¨è¯¦ç»†çŠ¶æ€ä¿¡æ¯ï¼ˆé»˜è®¤ï¼‰
listener.WithDetails(false)
```

### è‡ªå®šä¹‰å‰ç¼€å’Œæ¶ˆæ¯

ProgressListener æ”¯æŒè‡ªå®šä¹‰æ˜¾ç¤ºæ•ˆæœï¼š

```go
// è®¾ç½®è‡ªå®šä¹‰å‰ç¼€
listener.WithPrefix("ğŸš€")

// ä¸ºç‰¹å®šèŠ‚ç‚¹è®¾ç½®è‡ªå®šä¹‰æ¶ˆæ¯
listener.SetNodeStep("process", "æ­£åœ¨å¤„ç†æ•°æ®...")
```

### èŠå¤©é£æ ¼ç›‘å¬å™¨

ChatListener æä¾›å‹å¥½çš„å®æ—¶åé¦ˆï¼š

```go
// åˆ›å»ºèŠå¤©é£æ ¼ç›‘å¬å™¨
chat := NewChatListener()

// ä¸ºèŠ‚ç‚¹è®¾ç½®è‡ªå®šä¹‰æ¶ˆæ¯
chat.SetNodeMessage("analyze", "ğŸ” åˆ†ææ•°æ®ä¸­...")

// å¯ç”¨æ—¶é—´æˆ³
chat.WithTime(true)
```

**ç« èŠ‚æ¥æº**
- [graph/builtin_listeners.go](file://graph/builtin_listeners.go#L45-L433)

## æœ€ä½³å®è·µæŒ‡å—

### å¼€å‘é˜¶æ®µè°ƒè¯•

åœ¨å¼€å‘é˜¶æ®µï¼Œå»ºè®®ä½¿ç”¨ä»¥ä¸‹ç»„åˆï¼š

```go
// åˆ›å»ºç»¼åˆè°ƒè¯•ç›‘å¬å™¨ç»„
progress := NewProgressListener().
    WithTiming(true).
    WithDetails(true)

metrics := NewMetricsListener()

logging := NewLoggingListener().
    WithLogLevel(LogLevelDebug).
    WithState(true)

// å°†æ‰€æœ‰ç›‘å¬å™¨é™„åŠ åˆ°å…³é”®èŠ‚ç‚¹
node.AddListener(progress)
node.AddListener(metrics)
node.AddListener(logging)
```

### ç”Ÿäº§ç¯å¢ƒç›‘æ§

ç”Ÿäº§ç¯å¢ƒä¸­æ¨èçš„é…ç½®ï¼š

```go
// æ€§èƒ½ç›‘æ§ç›‘å¬å™¨
metrics := NewMetricsListener()

// ç»“æ„åŒ–æ—¥å¿—ç›‘å¬å™¨
logging := NewLoggingListener().
    WithLogLevel(LogLevelInfo).
    WithState(false)

// èŠå¤©é£æ ¼ç›‘å¬å™¨ï¼ˆç”¨äºå®æ—¶åé¦ˆï¼‰
chat := NewChatListener().
    WithTime(false)
```

### å¤šç›‘å¬å™¨åè°ƒ

åˆç†ç»„ç»‡å¤šä¸ªç›‘å¬å™¨çš„èŒè´£åˆ†å·¥ï¼š

- **ProgressListener**ï¼šæä¾›ç”¨æˆ·å‹å¥½çš„è¿›åº¦æ˜¾ç¤º
- **MetricsListener**ï¼šæ”¶é›†æ€§èƒ½æŒ‡æ ‡æ•°æ®
- **LoggingListener**ï¼šè®°å½•è¯¦ç»†çš„æ‰§è¡Œæ—¥å¿—
- **ChatListener**ï¼šæä¾›å®æ—¶äº¤äº’åé¦ˆ

**ç« èŠ‚æ¥æº**
- [examples/listeners/main.go](file://examples/listeners/main.go#L1-L132)

## æ€§èƒ½åˆ†æä¸ä¼˜åŒ–

### æ‰§è¡Œè½¨è¿¹åˆ†æ

é€šè¿‡ç›‘å¬å™¨ç»„åˆå¯ä»¥æ„å»ºå®Œæ•´çš„æ‰§è¡Œè½¨è¿¹ï¼š

```mermaid
graph TD
A["å·¥ä½œæµå¯åŠ¨"] --> B["ProgressListener: æ˜¾ç¤ºè¿›åº¦"]
B --> C["MetricsListener: è®°å½•å¼€å§‹æ—¶é—´"]
C --> D["LoggingListener: è®°å½•å¼€å§‹äº‹ä»¶"]
D --> E["å®é™…èŠ‚ç‚¹æ‰§è¡Œ"]
E --> F["MetricsListener: è®¡ç®—æ‰§è¡Œæ—¶é—´"]
F --> G["LoggingListener: è®°å½•æ‰§è¡Œç»“æœ"]
G --> H["ProgressListener: æ˜¾ç¤ºå®Œæˆ"]
H --> I["ç”Ÿæˆæ€§èƒ½æŠ¥å‘Š"]
```

### æ€§èƒ½ç“¶é¢ˆå®šä½

åˆ©ç”¨ MetricsListener è¿›è¡Œæ€§èƒ½åˆ†æï¼š

1. **è¯†åˆ«æ…¢èŠ‚ç‚¹**ï¼šé€šè¿‡å¹³å‡æ‰§è¡Œæ—¶é—´å‘ç°æ€§èƒ½ç“¶é¢ˆ
2. **é”™è¯¯ç‡åˆ†æ**ï¼šå®šä½é¢‘ç¹å¤±è´¥çš„èŠ‚ç‚¹
3. **èµ„æºä½¿ç”¨ç›‘æ§**ï¼šè·Ÿè¸ªå†…å­˜å’Œ CPU ä½¿ç”¨æƒ…å†µ
4. **å¹¶å‘æ€§èƒ½è¯„ä¼°**ï¼šåˆ†æå¤šèŠ‚ç‚¹å¹¶å‘æ‰§è¡Œæ•ˆæœ

### ä¼˜åŒ–ç­–ç•¥

åŸºäºç›‘æ§æ•°æ®çš„ä¼˜åŒ–å»ºè®®ï¼š

- **ç¼“å­˜æœºåˆ¶**ï¼šå¯¹é‡å¤è®¡ç®—çš„ç»“æœè¿›è¡Œç¼“å­˜
- **å¼‚æ­¥å¤„ç†**ï¼šå°†è€—æ—¶æ“ä½œç§»è‡³åå°æ‰§è¡Œ
- **æ‰¹é‡å¤„ç†**ï¼šåˆå¹¶å°ä»»åŠ¡å‡å°‘å¼€é”€
- **èµ„æºæ± åŒ–**ï¼šå¤ç”¨æ˜‚è´µçš„èµ„æºå¯¹è±¡

**ç« èŠ‚æ¥æº**
- [graph/builtin_listeners.go](file://graph/builtin_listeners.go#L202-L351)

## æ•…éšœæ’é™¤æŒ‡å—

### å¸¸è§é—®é¢˜è¯Šæ–­

#### æ¶ˆæ¯æœªæ­£ç¡®æ›´æ–°

**ç—‡çŠ¶**ï¼šæœŸæœ›çš„æ¶ˆæ¯æ›´æ–°æœªç”Ÿæ•ˆï¼Œå‡ºç°é‡å¤æ¶ˆæ¯

**æ’æŸ¥æ­¥éª¤**ï¼š
1. æ£€æŸ¥æ¶ˆæ¯ ID æ˜¯å¦æ­£ç¡®è®¾ç½®
2. éªŒè¯ ID ç±»å‹æ˜¯å¦ä¸€è‡´ï¼ˆå­—ç¬¦ä¸²ï¼‰
3. ç¡®è®¤æ¶ˆæ¯ç»“æ„ç¬¦åˆé¢„æœŸæ ¼å¼

**è§£å†³æ–¹æ¡ˆ**ï¼š
```go
// ç¡®ä¿ ID æ˜¯å­—ç¬¦ä¸²ç±»å‹
message := map[string]interface{}{
    "id":      "msg_123",           // å¿…é¡»æ˜¯å­—ç¬¦ä¸²
    "role":    "ai",
    "content": "æ›´æ–°å†…å®¹",
}
```

#### ç›‘å¬å™¨æ— è¾“å‡º

**ç—‡çŠ¶**ï¼šç›‘å¬å™¨é…ç½®åæ²¡æœ‰æ”¶åˆ°ä»»ä½•äº‹ä»¶é€šçŸ¥

**æ’æŸ¥æ­¥éª¤**ï¼š
1. ç¡®è®¤ç›‘å¬å™¨å·²æ­£ç¡®æ·»åŠ åˆ°èŠ‚ç‚¹
2. æ£€æŸ¥äº‹ä»¶ç±»å‹è¿‡æ»¤æ¡ä»¶
3. éªŒè¯ä¸Šä¸‹æ–‡ä¼ æ’­

**è§£å†³æ–¹æ¡ˆ**ï¼š
```go
// ç¡®ä¿ç›‘å¬å™¨æ·»åŠ åˆ°æ­£ç¡®çš„èŠ‚ç‚¹
node := graph.AddNode("process", processFunc)
node.AddListener(progressListener)
```

#### æ€§èƒ½ç›‘æ§æ•°æ®å¼‚å¸¸

**ç—‡çŠ¶**ï¼šMetricsListener æ˜¾ç¤ºçš„æ‰§è¡Œæ—¶é—´ä¸åˆç†

**æ’æŸ¥æ­¥éª¤**ï¼š
1. æ£€æŸ¥ç³»ç»Ÿæ—¶é’ŸåŒæ­¥
2. ç¡®è®¤å¹¶å‘å®‰å…¨
3. éªŒè¯æ—¶é—´è®¡ç®—é€»è¾‘

**ç« èŠ‚æ¥æº**
- [graph/builtin_listeners.go](file://graph/builtin_listeners.go#L202-L351)
- [graph/add_messages.go](file://graph/add_messages.go#L107-L134)

### è°ƒè¯•æŠ€å·§

1. **åˆ†å±‚è°ƒè¯•**ï¼šä»ç®€å•åˆ°å¤æ‚é€æ­¥å¢åŠ ç›‘å¬å™¨
2. **äº‹ä»¶è¿‡æ»¤**ï¼šä½¿ç”¨ç‰¹å®šçš„äº‹ä»¶ç±»å‹è¿›è¡Œé’ˆå¯¹æ€§è°ƒè¯•
3. **çŠ¶æ€æ£€æŸ¥**ï¼šåˆ©ç”¨ WithDetails é€‰é¡¹æŸ¥çœ‹å®Œæ•´çŠ¶æ€
4. **æ—¶é—´å¯¹æ¯”**ï¼šç»“åˆ WithTiming é€‰é¡¹è¿›è¡Œæ—¶é—´åˆ†æ

## æ€»ç»“

LangGraphGo çš„æ™ºèƒ½æ¶ˆæ¯æœºåˆ¶å’Œè°ƒè¯•æ”¯æŒç³»ç»Ÿä¸ºå¼€å‘è€…æä¾›äº†å¼ºå¤§è€Œçµæ´»çš„å·¥å…·é›†ã€‚æ™ºèƒ½æ¶ˆæ¯é€šè¿‡ ID åŒ¹é…å®ç°äº†æ¶ˆæ¯çš„æ›´æ–°ä¸å»é‡ï¼Œè§£å†³äº†ä¼ ç»ŸèŠå¤©åº”ç”¨ä¸­çš„æ¶ˆæ¯ç®¡ç†éš¾é¢˜ã€‚å†…ç½®ç›‘å¬å™¨ç³»ç»Ÿåˆ™æä¾›äº†å…¨é¢çš„ç›‘æ§ã€è°ƒè¯•å’Œæ€§èƒ½åˆ†æèƒ½åŠ›ã€‚

é€šè¿‡åˆç†é…ç½®å’Œä½¿ç”¨è¿™äº›åŠŸèƒ½ï¼Œå¼€å‘è€…å¯ä»¥ï¼š
- æ„å»ºæ›´åŠ æ™ºèƒ½å’Œå“åº”å¼çš„èŠå¤©åº”ç”¨
- å®ç°ç²¾ç¡®çš„æ‰§è¡Œç›‘æ§å’Œæ€§èƒ½åˆ†æ
- å¿«é€Ÿå®šä½å’Œè§£å†³å·¥ä½œæµä¸­çš„é—®é¢˜
- ä¼˜åŒ–ç³»ç»Ÿæ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ

åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå»ºè®®æ ¹æ®ä¸åŒçš„ä½¿ç”¨åœºæ™¯é€‰æ‹©åˆé€‚çš„ç›‘å¬å™¨ç»„åˆï¼Œå¹¶åœ¨å¼€å‘ã€æµ‹è¯•å’Œç”Ÿäº§ç¯å¢ƒä¸­é‡‡ç”¨ç›¸åº”çš„é…ç½®ç­–ç•¥ï¼Œä»¥æœ€å¤§åŒ–è¿™äº›åŠŸèƒ½çš„ä»·å€¼ã€‚